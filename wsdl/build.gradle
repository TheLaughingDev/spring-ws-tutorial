group 'org.thelaughingdev.soap'
version '1.0-SNAPSHOT'

configurations {
	jaxb
}

sourceCompatibility = 1.8
targetCompatibility = 1.8

//bootRepackage.enabled = false

jar {
	from "${buildDir}/classes/jaxb"
}

task genJaxb {
	ext.sourcesDir = "${buildDir}/generated-sources/jaxb"
	ext.classesDir = "${buildDir}/classes/jaxb"
	ext.schema = "../server/src/main/resources/countries.xsd"

	doLast() {
		project.ant {
			taskdef name: "xjc", classname: "com.sun.tools.xjc.XJCTask",
				classpath: configurations.jaxb.asPath
			mkdir(dir: sourcesDir)

			xjc(destdir: sourcesDir, schema: schema, package: "org.thelaughingdev.wsdl") {
				arg(value: "-wsdl")
				produces(dir: sourcesDir, includes: "**/*.java")
			}
		}
	}
}

compileJava {
	dependsOn genJaxb
	source genJaxb.sourcesDir
	destinationDir new File("${buildDir}/classes/jaxb")
}

dependencies {
	compile group: 'javax.xml.bind', name: 'jaxb-api', version: '2.3.0'
	compile group: 'org.glassfish.jaxb', name: 'jaxb-core', version: '2.3.0'
	compile group: 'com.sun.xml.bind', name: 'jaxb-impl', version: '2.3.0'

	jaxb("org.glassfish.jaxb:jaxb-xjc:2.3.0")
	compile(files(genJaxb.classesDir).builtBy(genJaxb))
}